{% extends "core/base.html" %}

{% block content %}
<style>
    .api-wrapper {
        max-width: 1100px;
        margin: 3rem auto;
        padding: 2rem 2.5rem;
        background: #f8f9fa;
        border-radius: 18px;
        box-shadow: 0 18px 45px rgba(0, 0, 0, 0.12);
    }

    .api-title {
        font-size: 1.8rem;
        margin-bottom: 0.3rem;
    }

    .api-subtitle {
        font-size: 0.95rem;
        color: #6c757d;
        margin-bottom: 1.5rem;
    }

    .api-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
    }

    .api-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 999px;
        font-size: 0.85rem;
        font-weight: 500;
    }

    .api-badge-total {
        background: #212529;
        color: #fff;
    }

    .api-badge-done {
        background: #198754;
        color: #fff;
    }

    .api-badge-pending {
        background: #ffc107;
        color: #212529;
    }

    .api-table thead th {
        border-bottom: 2px solid #dee2e6;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: .04em;
    }

    .api-table tbody td {
        vertical-align: middle;
        font-size: 0.95rem;
    }

    .api-status-pill {
        display: inline-block;
        padding: 0.15rem 0.6rem;
        border-radius: 999px;
        font-size: 0.8rem;
        font-weight: 500;
    }

    .api-status-ok {
        background: rgba(25, 135, 84, .12);
        color: #198754;
    }

    .api-status-pending {
        background: rgba(220, 53, 69, .08);
        color: #dc3545;
    }

    .api-footer {
        font-size: 0.85rem;
        color: #6c757d;
        margin-top: 1rem;
    }

    @media (max-width: 768px) {
        .api-wrapper {
            margin: 2rem 1rem;
            padding: 1.5rem;
        }

        .api-title {
            font-size: 1.4rem;
        }
    }
</style>

<div class="api-wrapper">
    <div class="d-flex justify-content-between align-items-start flex-wrap gap-2 mb-2">
        <div>
            <h1 class="api-title">Tareas internas de la galería (API GET)</h1>
            <p class="api-subtitle mb-0">
                Estas tareas se obtienen desde la API local de gestión de pendientes de la galería.
            </p>
        </div>
    </div>

    <div class="api-badges">
        <span class="api-badge api-badge-total">
            Total de tareas: {{ total }}
        </span>
        <span class="api-badge api-badge-done">
            Completadas: {{ completados }}
        </span>
        <span class="api-badge api-badge-pending">
            Pendientes: {{ pendientes }}
        </span>
    </div>

    <div class="table-responsive">
        <table class="table table-hover api-table mb-0">
            <thead>
                <tr>
                    <th style="width: 70px;">ID</th>
                    <th>Tarea</th>
                    <th style="width: 140px;">Estado</th>
                    <th style="width: 170px;">Fecha creación</th>
                </tr>
            </thead>
            <tbody>
                {% for t in tickets %}
                <tr>
                    <td>#{{ t.id }}</td>
                    <td>{{ t.task }}</td>
                    <td>
                        {% if t.completed %}
                        <span class="api-status-pill api-status-ok">Completada</span>
                        {% else %}
                        <span class="api-status-pill api-status-pending">Pendiente</span>
                        {% endif %}
                    </td>
                    <td>{{ t.timestamp }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center text-muted py-4">
                        No hay tareas registradas en la API.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <p class="api-footer">
        Datos consumidos desde la API local <code>/api/tickets/</code>.
    </p>
</div>
{% endblock %}